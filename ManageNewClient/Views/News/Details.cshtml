@{
    ViewData["Title"] = "News Details";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
    #title {
        text-transform: capitalize;
    }

    #image {
        width: 100%;
        height: auto;
    }

    .wraper {
        display: flex;
        gap: 12px;
        align-items: center;
    }

    .wraper-title{
        font-weight:700;
    }
    
    p{
        margin: 0;
    }

    .news-details {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .like-btn{
        font-size: 24px;
    }

    .like-btn-color{
        color: #0d6efd;
    }

    .comment {
        display:flex;
        flex-direction:column;
        gap:8px;
    }

    .comment button{
        margin-left: auto;
    }
</style>

<div class="container">
    <div class="news-details">
        <h1 id="title"></h1>
        <img id="image" src="" alt="News Image">
        <div class="wraper">
            <p class="wraper-title"> Posted Date: </p>
            <p id="postedDate"></p>
        </div>
        <div class="wraper">
            <p class="wraper-title"> Created By: </p>
            <p id="createdBy"></p>
        </div>
        <div id="content"></div>
        <div class="wraper">
            <i onclick="myFunction(this)" class="fa fa-thumbs-up like-btn"></i>
            <div id="like"></div>
        </div>
        <div class="comment">
            <textarea placeholder="Enter your comment" rows="6"></textarea>
            <button class="btn btn-primary" type="submit">Submit</button>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Function to fetch and display the details of a news article
        function fetchNewsDetails() {
            let params = (new URL(document.location)).searchParams;
            let articleId = params.get("id");
            console.log(articleId)
            // Make an AJAX GET request to fetch the article details
            $.ajax({
                url: `https://localhost:7255/api/News/GetById/id?id=${articleId}`,
                type: "GET",
                dataType: "json",
                success: function (data) {
                    // Populate the HTML elements with the fetched data
                    $("#title").text(data.title);
                    $("#image").attr("src", data.imgPath);
                    $("#postedDate").text(data.postedDate);
                    $("#content").html(data.content);
                    $("#createdBy").text( data.createdBy);
                    $("#like").text(data.numberOfLikes);
                },
                error: function (error) {
                    console.error("Error fetching news article details:", error);
                }
            });
        }

        // Call the function to fetch and display news article details
        fetchNewsDetails();

        function myFunction(x) {
            if (x.classList.contains("like-btn-color"))
            {
                $("#like").text(parseInt($("#like").text()) - 1);
            }
            else 
            {
                $("#like").text(parseInt($("#like").text()) + 1);
            };
            x.classList.toggle("like-btn-color");
        }
    </script>
}
